# Class Mapping

This directory contains mappings between deobfuscated class names (from Mopar 317 deobfuscated client) and obfuscated class names (from original RuneScape 317 bytecode).

## Files

- `class_mapping.csv` - CSV format with high confidence (≥85.0) and uncertain (<85.0) matches
- `class_mapping.json` - Complete JSON with detailed score breakdowns

## How to Regenerate

To regenerate these files from project root:
```bash
# Generate both CSV and JSON
./tools/classmapper/classmapper -mode csv > bytecode/mapping/class_mapping.csv
./tools/classmapper/classmapper -mode json > bytecode/mapping/class_mapping.json
```

## CSV Format

Columns:
- deobfuscated_name - Deobfuscated class name
- obfuscated_name - Obfuscated class name
- confidence_score - Confidence score (0-100)
- superclass_match - Whether superclass matches
- interface_count - Number of matching interfaces
- field_count_deob - Field count in deobfuscated class
- field_count_obf - Field count in obfuscated class
- method_count_deob - Method count in deobfuscated class
- method_count_obf - Method count in obfuscated class
- notes - Match reasoning

## JSON Format

Complete structure with:
- `summary` - Total matches, high/medium/low confidence counts
- `matches` - Array of match objects with:
  - `DeobfuscatedClass` - Deobfuscated class name
  - `ObfuscatedClass` - Obfuscated class name
  - `ConfidenceScore` - Confidence score (0-100)
  - `ScoreBreakdown` - Detailed scoring breakdown:
    - `InterfaceMatch` - Interface matching points
    - `SuperclassMatch` - Superclass matching points
    - `FieldCountMatch` - Field count matching points
    - `FieldSimilarity` - Field type similarity
    - `MethodCountMatch` - Method count matching points
    - `MethodSimilarity` - Method signature similarity
    - `ConstructorMatch` - Constructor matching points
    - `AccessMatch` - Access modifier matching points
    - `SizePenalty` - Size difference penalty
  - `Details` - Human-readable match reasoning

## Confidence Scoring

Matches are scored on a 0-100 scale using:

- **Interface matching** (20 points) - Exact interface matches
- **Superclass matching** (25 points) - Superclass matches
- **Field count/type similarity** (15 points) - Field matching
- **Method count/signature similarity** (25 points) - Method matching
- **Constructor matching** (5 points) - Constructor count
- **Access modifier matching** (5 points) - Access modifier matches
- **Size penalty** (-10 points) - Applied for significant size differences

**Thresholds**:
- **High confidence**: ≥85.0
- **Medium confidence**: 65.0-84.9
- **Low confidence**: <65.0

## Known Anchor Mappings

The tool uses these pre-configured anchor classes for exact matches:
- `Node` → `PKVMXVTO`
- `NodeSub` → `PPOHBEGB`
- `RSApplet` → `KHACHIFW`
- `client` → `client`
- `sign/signlink` → `sign/signlink`

These are matched with 100.0 confidence scores.

## Notes

Generated by classmapper tool
Source: Mopar 317 deobfuscated (srcAllDummysRemoved/bin/)
Target: RuneScape 317 obfuscated (bytecode/client/)
Date: $(date)